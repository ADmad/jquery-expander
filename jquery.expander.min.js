/*!
 * jQuery Expander Plugin v1.3.1
 *
 * Date: Sat Dec 03 23:22:55 2011 EST
 * Requires: jQuery v1.3+
 *
 * Copyright 2011, Karl Swedberg
 * Dual licensed under the MIT and GPL licenses (just like jQuery):
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 *
 *
 *
*/
(function(c){c.expander={version:"1.3.1",defaults:{slicePoint:100,preserveWords:true,widow:4,expandText:"read more",expandPrefix:"&hellip; ",summaryClass:"summary",detailClass:"details",moreClass:"read-more",lessClass:"read-less",collapseTimer:0,expandEffect:"fadeIn",expandSpeed:250,collapseEffect:"fadeOut",collapseSpeed:200,userCollapse:true,userCollapseText:"read less",userCollapsePrefix:" ",onSlice:null,beforeExpand:null,afterExpand:null,onCollapse:null}};c.fn.expander=function(G){function H(a,
e){var h="span",g=a.summary;if(e){h="div";if(u.test(g))g=g.replace(u,a.moreLabel+"$1");else g+=a.moreLabel;g='<div class="'+a.summaryClass+'">'+g+"</div>"}else g+=a.moreLabel;return[g,"<",h+' class="'+a.detailClass+'"',">",a.details,"</"+h+">"].join("")}function I(a){var e='<span class="'+a.moreClass+'">'+a.expandPrefix;e+='<a href="#">'+a.expandText+"</a></span>";return e}function v(a,e){if(a.lastIndexOf("<")>a.lastIndexOf(">"))a=a.slice(0,a.lastIndexOf("<"));if(e)a=a.replace(J,"");return a}function w(a,
e){e.stop(true,true)[a.collapseEffect](a.collapseSpeed,function(){e.prev("span."+a.moreClass).show().length||e.parent().children("div."+a.summaryClass).show().find("span."+a.moreClass).show()})}function K(a,e,h){if(a.collapseTimer)x=setTimeout(function(){w(a,e);c.isFunction(a.onCollapse)&&a.onCollapse.call(h,false)},a.collapseTimer)}var y=c.extend({},c.expander.defaults,G),L=/^<(?:area|br|col|embed|hr|img|input|link|meta|param).*>$/i,J=/(&(?:[^;]+;)?|\w+)$/,M=/<\/?(\w+)[^>]*>/g,z=/<(\w+)[^>]*>/g,
A=/<\/(\w+)>/g,u=/(<\/[^>]+>)\s*$/,N=/^<[^>]+>.?/,x;this.each(function(){var a,e,h,g,l,k,n,t,B=[],r=[],o={},p=this,f=c(this),C=c([]),b=c.meta?c.extend({},y,f.data()):y;k=!!f.find("."+b.detailClass).length;var q=!!f.find("*").filter(function(){return/^block|table|list/.test(c(this).css("display"))}).length,s=(q?"div":"span")+"."+b.detailClass,D="span."+b.moreClass,O=b.expandSpeed||0,m=c.trim(f.html());c.trim(f.text());var d=m.slice(0,b.slicePoint);if(!c.data(this,"expander")){c.data(this,"expander",
true);c.each(["onSlice","beforeExpand","afterExpand","onCollapse"],function(i,j){o[j]=c.isFunction(b[j])});d=v(d);for(summTagless=d.replace(M,"").length;summTagless<b.slicePoint;){newChar=m.charAt(d.length);if(newChar=="<")newChar=m.slice(d.length).match(N)[0];d+=newChar;summTagless++}d=v(d,b.preserveWords);g=d.match(z)||[];l=d.match(A)||[];h=[];c.each(g,function(i,j){L.test(j)||h.push(j)});g=h;e=l.length;for(a=0;a<e;a++)l[a]=l[a].replace(A,"$1");c.each(g,function(i,j){var E=j.replace(z,"$1"),F=c.inArray(E,
l);if(F===-1){B.push(j);r.push("</"+E+">")}else l.splice(F,1)});r.reverse();if(k){a=f.find(s).remove().html();d=f.html();m=d+a;k=""}else{a=m.slice(d.length);if(a.split(/\s+/).length<b.widow&&!k)return;k=r.pop()||"";d+=r.join("");a=B.join("")+a}b.moreLabel=f.find(D).length?"":I(b);if(q)a=m;d+=k;b.summary=d;b.details=a;b.lastCloseTag=k;if(o.onSlice)b=(h=b.onSlice.call(p,b))&&h.details?h:b;q=H(b,q);f.html(q);n=f.find(s);t=f.find(D);n.hide();t.find("a").unbind("click.expander").bind("click.expander",
function(i){i.preventDefault();t.hide();C.hide();o.beforeExpand&&b.beforeExpand.call(p);n.stop(false,true)[b.expandEffect](O,function(){n.css({zoom:""});o.afterExpand&&b.afterExpand.call(p);K(b,n,p)})});C=f.find("div."+b.summaryClass);b.userCollapse&&!f.find("span."+b.lessClass).length&&f.find(s).append('<span class="'+b.lessClass+'">'+b.userCollapsePrefix+'<a href="#">'+b.userCollapseText+"</a></span>");f.find("span."+b.lessClass+" a").unbind("click.expander").bind("click.expander",function(i){i.preventDefault();
clearTimeout(x);i=c(this).closest(s);w(b,i);o.onCollapse&&b.onCollapse.call(p,true)})}});return this};c.fn.expander.defaults=c.expander.defaults})(jQuery);
